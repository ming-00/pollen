<% provide(:title, "Forum") %>
<div class="row">
    <aside id="left-scroll">
        <section class="w3-container">
            <br>
            <br>
            <div class="tiny-avatar">
                <%= avatar_for(@forumposts.user) %>
            </div>
            <div class="entry-title">
                <%= @forumposts.title %>
                <% if @forumposts.accepted %>
                <svg width="1em" height="1em" id="resolved-icon" data-toggle="tooltip" title="Thread is resolved" data-container="body" viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                </svg>
            <% end %>
            </div>
            <div class="entry-particulars">
                thread by
                <%=  link_to "#{@forumposts.user.firstname} #{@forumposts.user.lastname}", @forumposts.user%>
                <% case @forumposts.user.points %>
                <% when 1...5 %>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level1" class="bi bi-award-fill" data-toggle="tooltip" title="seed" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                    </svg>
                <% when 5...10 %>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level2" class="bi bi-award-fill" data-toggle="tooltip" title="sprout" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                    </svg>
                <% when 10...25 %>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level3" class="bi bi-award-fill" data-toggle="tooltip" title="seedling" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                    </svg>
                <% when 25...50 %>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level4" class="bi bi-award-fill" data-toggle="tooltip" title="sapling" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                    </svg>
                <% else %>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level5" class="bi bi-award-fill" data-toggle="tooltip" title="tree" data-container="body" class="bi bi-trophy" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 1h10c-.495 3.467-.5 10-5 10S3.495 4.467 3 1zm0 15a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1H3zm2-1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1H5z"/>
                        <path fill-rule="evenodd" d="M12.5 3a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-3 2a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm-6-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-3 2a3 3 0 1 1 6 0 3 3 0 0 1-6 0z"/>
                        <path d="M7 10h2v4H7v-4z"/>
                        <path d="M10 11c0 .552-.895 1-2 1s-2-.448-2-1 .895-1 2-1 2 .448 2 1z"/>
                    </svg>
            <% end %>
                ·   
                posted <%= time_ago_in_words(@forumposts.created_at) %> ago
                <br>
                <br>
            </div>
            <div class="entry-content">
                <%= markdown(@forumposts.content) %>
                <br>
                <br>
            </div>
            <div class="thread-page-tag">
                <%= render @forumposts.tags %>
            </div>
            <% pre_like = @forumposts.forumpostlikes.find { |like| like.user_id == current_user.id} %>
            <div class="entry-stats">
                <% if pre_like %>
                    <%= link_to forumpost_forumpostlike_path(@forumposts, pre_like), method: :delete do %>
                        <svg width="1em" height="1em" viewBox="0 0 16 16" id = "unlike-heart" data-toggle="tooltip" title="unlike" data-container="body" class="bi bi-heart-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                        </svg>
                    <% end %>
                <% else %>
                    <%= link_to forumpost_forumpostlikes_path(@forumposts), method: :forumpost do %>
                        <svg width="1em" height="1em" viewBox="0 0 16 16" id = "like-heart" data-toggle="tooltip" title="like" data-container="body" class="bi bi-heart-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                        </svg>
                    <% end %>
                <% end %>
                <%= @forumposts.forumpostlikes.count %>  
                <svg width="1em" height="1em" id = "likes" data-toggle="tooltip" title="comments" data-container="body" viewBox="0 0 16 16" class="bi bi-chat-dots-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                </svg>
                <%= @forumposts.commentforums.count %>
                <svg width="1em" height="1em" id = "likes" data-toggle="tooltip" title="views" data-container="body" viewBox="0 0 16 16" class="bi bi-eye-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
                    <path fill-rule="evenodd" d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
                </svg>
                <%= @forumposts.hits %>
            </div>
            <div class="entry-particulars">
                <% if current_user == @forumposts.user %>
                    <% if @forumposts.accepted == false %>
                        <%= link_to "mark as resolved", markaccepted_forumpost_path %> /
                    <% else %>
                        <%= link_to "mark as unresolved", markaccepted_forumpost_path %> /
                    <% end %>
                    <%= link_to "edit", edit_forumpost_path(@forumposts) %> 
                    /
                    <%= link_to "delete", @forumposts, method: :delete,
                    data: { confirm: "This thread will be permanently deleted." } %>
                <% else %>
                    <%= link_to "back to forum", "welcome#forum" %>
                <%end%>
            </div>
        </section> 
        <div>
            <% @forumposts.commentforums.each do |l| %>
                <ol class="listing-replies">
                    <section class="w3-container">
                        <br>
                        <br>
                        <div class="tiny-aligned-avatar">
                            <%= avatar_for(l.user) %>
                        </div>
                        <div class="forumpost-content">
                            <%= markdown(l.reply) %>
                        </div>
                        <br>
                        <% pre_like = l.commentforumlikes.find { |like| like.user_id == current_user.id} %>
                        <div class="entry-stats">
                            <br>
                            <% if l.reply.size <= 169 %>
                                <br>
                            <%end%>
                            <% if l.reply.size <= 84 %>
                                <br>
                            <%end%>
                            <% if pre_like %>
                                <%= link_to forumpost_commentforum_commentforumlike_path(l.forumpost, l, pre_like), method: :delete do %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id = "unlike-heart" data-toggle="tooltip" title="unlike" data-container="body" class="bi bi-heart-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                                    </svg>
                                <% end %>
                            <% else %>
                            <%= link_to forumpost_commentforum_commentforumlikes_path(l.forumpost, l), method: :post do %>
                                <svg width="1em" height="1em" viewBox="0 0 16 16" id = "like-heart" data-toggle="tooltip" title="like" data-container="body" class="bi bi-heart-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                                </svg>
                            <% end %>
                            <% end %>
                            <%= l.commentforumlikes.count %>  
                        </div>
                        <div class="entry-particulars">
                            <% if l.reply.size <= 168 %>
                                <br>
                            <%end%>
                            <% if l.reply.size <= 84 %>
                                <br>
                            <%end%>
                            <% if current_user == l.forumpost.user %>
                                <% if l.accepted == true %>
                                    <%= link_to "unaccept comment", markaccepted_commentforum_path(l.forumpost.id, l.id) %>
                                <% else %>
                                    <%= link_to "accept comment", markaccepted_commentforum_path(l.forumpost.id, l.id) %>
                                <% end %>      
                            <% end %>
                            <% if current_user == l.user %>
                                <% if current_user == l.forumpost.user %>
                                /
                                <% end %>

                                <%= link_to "edit", edit_forumpost_commentforum_path(l.forumpost, l) %>
                                /
                                <%= link_to "delete", [l.forumpost, l], method: :delete,
                                    data: { confirm: "This comment will be permanently deleted." } %>
                            <%end%>
                            <br>
                            <% if l.accepted %>
                                <svg width="1em" height="1em" id="resolved-icon-2" data-toggle="tooltip" title="Comment is accepted by author" data-container="body" viewBox="0 0 16 16" class="bi bi-check-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                                </svg>
                            <%end%>
                            comment by
                            <%=  link_to "#{l.user.firstname} #{l.user.lastname}", l.user%>
                            <% case l.user.points %>
                                <% when 1...5 %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level1" class="bi bi-award-fill" data-toggle="tooltip" title="seed" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                                    </svg>
                                <% when 5...10 %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level2" class="bi bi-award-fill" data-toggle="tooltip" title="sprout" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                                    </svg>
                                <% when 10...25 %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level3" class="bi bi-award-fill" data-toggle="tooltip" title="seedling" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                                    </svg>
                                <% when 25...50 %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level4" class="bi bi-award-fill" data-toggle="tooltip" title="sapling" data-container="body" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
                                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                                    </svg>
                                <% else %>
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" id="level5" class="bi bi-award-fill" data-toggle="tooltip" title="tree" data-container="body" class="bi bi-trophy" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M3 1h10c-.495 3.467-.5 10-5 10S3.495 4.467 3 1zm0 15a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1H3zm2-1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1H5z"/>
                                        <path fill-rule="evenodd" d="M12.5 3a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-3 2a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm-6-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-3 2a3 3 0 1 1 6 0 3 3 0 0 1-6 0z"/>
                                        <path d="M7 10h2v4H7v-4z"/>
                                        <path d="M10 11c0 .552-.895 1-2 1s-2-.448-2-1 .895-1 2-1 2 .448 2 1z"/>
                                    </svg>
                            <% end %>
                            ·   
                            posted <%= time_ago_in_words(l.created_at) %> ago
                        </div>
                    </section> 
                </ol>
            <% end %>
        </div>    
    </aside>
        <%= render 'commentforums/form' %>  
</div>